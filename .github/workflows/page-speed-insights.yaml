name: Page Seed Insight

on: [push]

# PSI_APIKEY = @see https://developers.google.com/speed/docs/insights/v5/get-started
jobs:
  Page-Speed-Insight:
    runs-on: ubuntu-latest
    steps:
      - name: "branch name check"
      - run: echo 'branch name = ' ${{ github.head_ref }}
      - if: ${{ github.ref_name }} == 'main'
      - run: echo 'https://next-startup-gilt.vercel.app/' > URL
      - if: ${{ github.ref_name }} != 'development'
      - run: echo 'https://next-startup-gilt-development-yokohama1.vercel.app/' > URL

      - name: "[ Mobile ] Running Page Speed Insights"
        uses: jakepartusch/psi-action@v1.2
        id: mobile_page_speed_insigths
        with:
          url: ${{ URL }}
          threshold: 90
          strategy: mobile
          key: ${{ secrets.PSI_APIKEY }}

      - name: "[ Desktop ] Running Page Speed Insights"
        uses: jakepartusch/psi-action@v1.2
        id: desktop_page_speed_insigths
        with:
          url: ${{ URL }}
          threshold: 90
          strategy: desktop
          key: ${{ secrets.PSI_APIKEY }}